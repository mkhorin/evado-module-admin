<% layout(_view.get(_layout)) %>
<% block('title', model.getAttrValueLabel('type')) %>
<%
const relationTemplate = _view.get('_part/attr/relation');
const stringTemplate = _view.get('_part/attr/string');
%>
<%- include(stringTemplate, {
    attr: 'name'
}) %>

<%- include(stringTemplate, {
    attr: 'label'
}) %>

<%- include(_view.get('_part/group/tabs'), {
    items: [{
        id: 'Main',
        active: true,
        content: [{
            template: _view.get('_part/attr/text'),
            attr: 'description'
        }]
    }, {
        id: 'Permissions',
        content: {
            template: relationTemplate,
            attr: 'childPermissions',
            css: 'no-label',
            data: {
                columns: [{
                    name: 'name',
                    sortable: true
                }, {
                    name: 'label',
                    sortable: true
                }, {
                    name: 'description'
                }],
                link: ['select', {list: _url('list-permissions', model)}],
                update: 'update-permission',
                delete: null
            }
        }
    }, {
        id: 'Hierarchy',
        content: [{
            template: relationTemplate,
            attr: 'childRoles',
            extHint: 'Items contained in the current',
            data: {
                columns: [{
                    name: 'type',
                    format: 'label',
                    sortable: true
                },{
                    name: 'name',
                    sortable: true
                },{
                    name: 'label',
                    sortable: true
                },{
                    name: 'description'
                }],
                order: {name: 1},
                link: ['select', {list: _url('list-roles', model)}],
                update: 'update-role',
                delete: null
            }
        }, {
            template: relationTemplate,
            attr: 'parentRoles',
            extHint: 'Items containing the current',
            data: {
                columns: [{
                    name: 'type',
                    format: 'label',
                    sortable: true
                },{
                    name: 'name',
                    sortable: true
                },{
                    name: 'label',
                    sortable: true
                },{
                    name: 'description'
                }],
                order: {name: 1},
                link: ['select', {list: _url('list-roles', model)}],
                update: 'update-role',
                delete: null
            }
        }]
    }, {
        id: 'Assignments',
        content: [{
            template: relationTemplate,
            attr: 'users',
            relRoute: '/admin/user',
            data: {
                columns: [{
                    name: 'name',
                    sortable: true
                },{
                    name: 'email',
                    sortable: true
                }],
                order: {name: 1},
                create: null,
                delete: null
            }
        }, {
            template: relationTemplate,
            attr: 'assignmentRules',
            extHint: 'Role will be assigned if at least one rule is allowed',
            data: {
                columns: [{
                    name: 'name',
                    sortable: true
                },{
                    name: 'label',
                    sortable: true
                },{
                    name: 'config'
                },{
                    name: 'description'
                }],
                order: {name: 1},
                delete: null
            }
        }]
    }, {
        id: 'Rule',
        content: {
            template: relationTemplate,
            attr: 'rule',
            css: 'no-label',
            data: {
                columns: [{
                    name: 'name',
                    sortable: true
                }, {
                    name: 'label',
                    sortable: true
                }, {
                    name: 'config'
                }, {
                    name: 'description'
                }],
                delete: null
            }
        }
    }]
}) %>